<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Go | Ailzr's Blog</title><meta name="author" content="Ailzr,ailzr@outlook.com"><meta name="copyright" content="Ailzr"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言：该文档阅读需要有一定的编程语言基础，这里将默认读者已经学习过一门或多门编程语言 补充：该文档更倾向于个人笔记，如果想学习，可以读 Go 语言圣经：Go 语言圣经中文版 # Go 语言介绍 Go 语言的三个作者：Rob Pike (罗伯。派克)，Ken Thompson (肯。汤普森) 和 Robert Griesemer (罗伯特。格利茨默) Rob Pike：曾是贝尔实验室 (Bell L">
<meta property="og:type" content="article">
<meta property="og:title" content="Go">
<meta property="og:url" content="https://www.ailzr.com/2023/06/28/GoLearn/index.html">
<meta property="og:site_name" content="Ailzr&#39;s Blog">
<meta property="og:description" content="前言：该文档阅读需要有一定的编程语言基础，这里将默认读者已经学习过一门或多门编程语言 补充：该文档更倾向于个人笔记，如果想学习，可以读 Go 语言圣经：Go 语言圣经中文版 # Go 语言介绍 Go 语言的三个作者：Rob Pike (罗伯。派克)，Ken Thompson (肯。汤普森) 和 Robert Griesemer (罗伯特。格利茨默) Rob Pike：曾是贝尔实验室 (Bell L">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.ailzr.com/assets/GoLearn.jpg">
<meta property="article:published_time" content="2023-06-28T11:46:13.000Z">
<meta property="article:modified_time" content="2023-08-20T13:41:48.381Z">
<meta property="article:author" content="Ailzr">
<meta property="article:tag" content="Go">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.ailzr.com/assets/GoLearn.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://www.ailzr.com/2023/06/28/GoLearn/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Go',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-20 21:41:48'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Ailzr's Blog"><img class="site-icon" src="/img/favicon.ico#%20image"/><span class="site-name">Ailzr's Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Go</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-28T11:46:13.000Z" title="发表于 2023-06-28 19:46:13">2023-06-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-08-20T13:41:48.381Z" title="更新于 2023-08-20 21:41:48">2023-08-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E7%AC%94%E8%AE%B0/">编程笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="leancloud_visitors" id="/2023/06/28/GoLearn/" data-flag-title="Go"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span class="leancloud-visitors-count"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><p><strong>前言：该文档阅读需要有一定的编程语言基础，这里将默认读者已经学习过一门或多门编程语言</strong></p>
<p><strong>补充：该文档更倾向于个人笔记，如果想学习，可以读 Go 语言圣经：<a target="_blank" rel="noopener" href="https://gopl-zh.github.io/index.html">Go 语言圣经中文版</a></strong></p>
<h1 id="go语言介绍"><a class="markdownIt-Anchor" href="#go语言介绍">#</a> Go 语言介绍</h1>
<p>Go 语言的三个作者：Rob Pike (罗伯。派克)，Ken Thompson (肯。汤普森) 和 Robert Griesemer (罗伯特。格利茨默)</p>
<p>Rob Pike：曾是贝尔实验室 (Bell Labs) 的 Unix 团队，和 Plan 9 操作系统计划的成员。他与 Thompson 共事多年，并共创出广泛使用的 UTF-8 字元编码。</p>
<p>Ken Thompson：主要是 B 语言、C 语言的作者、Unix 之父。 1983 年图奖 (Turing Award) 和 1998 年美国国家技术奖 (National Medal ofTechnology) 得主。他与 Dennis Ritchie 是 Unix 的原创者。Thompson 也发明了 后来衍生出 C 语言的 B 程序语言。</p>
<p>Robert Griesemer：在开发 Go 之前是 Google V8、Chubby 和 HotSpot JVM 的主要贡献者。</p>
<p>Go 语言出现的目的在于平衡开发速度与运行速度，相较于 C/C++，Go 语言能够实现更快速的开发，而相较于 Java，Go 语言能实现更快速的运行。当然，这只是通常而言，并不绝对。</p>
<h1 id="go语言环境安装"><a class="markdownIt-Anchor" href="#go语言环境安装">#</a> Go 语言环境安装</h1>
<p><strong>打开 Go 语言的<a target="_blank" rel="noopener" href="https://golang.google.cn/dl/">官网下载</a></strong></p>
<h2 id="windowswin11"><a class="markdownIt-Anchor" href="#windowswin11">#</a> <strong>Windows(win11)</strong></h2>
<ol>
<li>找到 windows 系统对应的包进行下载，例如这里选择种类 (Kind) 为压缩包 (Archive)，系统 (OS) 为 Windows，64 位 (x86-64) 进行下载</li>
<li>下载好后将压缩包进行解压</li>
<li>文件资源管理器 ==&gt; 右键此电脑 ==&gt; 属性 ==&gt; 高级系统设置 ==&gt; 环境变量</li>
<li>新建变量 GO_HOME，变量值设置为刚刚解压的 go 文件</li>
<li>编辑 Path 变量，在 Path 变量中新建：% GO_HOME%\bin</li>
<li>按 win+r 键，输入 cmd，打开命令窗口，使用 go version 检查环境是否配置完成，如果出现 go 语言的版本，则表明配置成功</li>
</ol>
<h2 id="linuxunbuntu"><a class="markdownIt-Anchor" href="#linuxunbuntu">#</a> <strong>Linux(Unbuntu)</strong></h2>
<ol>
<li>
<p>使用 uname -a (其他 Linux 系统指令自行查找) 指令查看系统指令集，我这里是 x86_64</p>
</li>
<li>
<p>找到 Linux 系统对应的包进行下载，例如这里选择种类 (Kind) 为压缩包 (Archive)，系统 (OS) 为 Linux，指令集 x86_64</p>
</li>
<li>
<p>打开到下载路径，然后使用指令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf go压缩包名(自行替换) -C /usr/local</span><br></pre></td></tr></table></figure>
<p>进行解压，解压目标路径为 /usr/local</p>
</li>
<li>
<p>使用 vim 修改 /etc/profile 文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile</span><br></pre></td></tr></table></figure>
<p>在文件最后添加内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export GOROOT=/usr/local/go</span><br><span class="line">export PATH=$PATH:$GOROOT/bin</span><br></pre></td></tr></table></figure>
<p>保存退出。</p>
</li>
<li>
<p>调用指令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>使用 go version 命令检查是否配置成功，如果出现 go 语言的版本，则标明配置成功。</p>
</li>
</ol>
<h2 id="编译运行"><a class="markdownIt-Anchor" href="#编译运行">#</a> 编译运行</h2>
<p>使用 go build FileName.go 来编译 go 文件，编译后会出现相应的可执行文件，进行执行即可，例如编写文件 Hello.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后对其进行编译运行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">编译</span></span><br><span class="line">go build Hello.go</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">运行，Windows系统下会生成Hello.exe，直接双击执行即可</span></span><br><span class="line">./Hello</span><br></pre></td></tr></table></figure>
<p>也可以使用 go run 指令直接运行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go run Hello.go</span><br></pre></td></tr></table></figure>
<p>但对于代码较多的文件并不推荐使用 go run，最好还是先编译再执行。</p>
<h1 id="go基础语法"><a class="markdownIt-Anchor" href="#go基础语法">#</a> Go 基础语法</h1>
<h2 id="注意点"><a class="markdownIt-Anchor" href="#注意点">#</a> 注意点</h2>
<ul>
<li>注释的方式和 C 语言一致。</li>
<li>运算符、流程控制等不再赘述，与其他语言基本保持一致。</li>
<li>需要注意的是使用 switch 时，不再需要使用 break 来避免穿透现象，Go 语言的 switch 没有穿透现象。</li>
<li>Go 语言中没有 while 和 do while 循环，仅有 for 循环。</li>
<li><strong>Go 语言的变量声明出来就必须调用，不调用会报错！</strong></li>
<li>Go 语言结尾不需要添加分号来标志语句结束。</li>
<li><strong>Go 语言流程控制语句，大括号必须跟在关键词后面，不能另起一行，例如：只有 if condition {正确</strong></li>
<li><strong>Go 语言的 if 语句，for 循环，switch 语句不需要使用小括号，如 switch 直接写 switch key {}</strong></li>
</ul>
<h2 id="变量声明与赋值"><a class="markdownIt-Anchor" href="#变量声明与赋值">#</a> 变量声明与赋值</h2>
<p>声明一个变量 s1，并指定其类型为 string 类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 <span class="type">string</span></span><br></pre></td></tr></table></figure>
<p>直接赋值，让编译器自行推导其类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s2 = <span class="string">&quot;String&quot;</span></span><br></pre></td></tr></table></figure>
<p>短变量声明，这种声明方式仅能在函数的内部使用</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s3 := <span class="string">&quot;String&quot;</span></span><br></pre></td></tr></table></figure>
<p>匿名变量，用于接受一些不需要使用的值，例如接受数组索引</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_<span class="comment">//下划线表示匿名变量</span></span><br></pre></td></tr></table></figure>
<h2 id="for-range"><a class="markdownIt-Anchor" href="#for-range">#</a> <mark>for range</mark></h2>
<p>for 循环的另一种使用方式，和 python 类似，例如：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="comment">//导入fmt包，这个包应该是用于io流的</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//声明数组arr</span></span><br><span class="line">	arr := [...]<span class="type">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;</span><br><span class="line">    <span class="comment">//使用for range遍历arr数组，使用匿名变量接收数组索引，i接收数组的值</span></span><br><span class="line">	<span class="keyword">for</span> _, i := <span class="keyword">range</span> arr &#123;</span><br><span class="line">        <span class="comment">//打印</span></span><br><span class="line">		fmt.Println(i)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="数组与切片"><a class="markdownIt-Anchor" href="#数组与切片">#</a> <mark>数组与切片</mark></h2>
<p>声明一个长度为 5 的 int 数组</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 [<span class="number">5</span>]<span class="type">int</span></span><br></pre></td></tr></table></figure>
<p>声明并初始化一个 int 数组，其中… 表示让编译器自行判断数组长度</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr2 = [...]<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>&#125;</span><br></pre></td></tr></table></figure>
<p>短变量声明法声明一个数组</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr3 := [...]<span class="type">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>&#125;</span><br></pre></td></tr></table></figure>
<p>多维数组不再赘述<br>
需要注意的是，Go 语言中的数组是值类型而非引用类型，换言之，传递时进行的是值传递而非指针传递</p>
<hr>
<p>声明一个 int 切片，切片类似于 C 语言的数组，属于引用类型，传递时是指针传递而非值传递</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> slice1 []<span class="type">int</span></span><br></pre></td></tr></table></figure>
<p>使用 make 函数初始化一个切片，其变量类型 int 可变，len 为切片长度，cap 为切片容量，cap 可省略</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> slice2 []<span class="type">int</span> = <span class="built_in">make</span>([]<span class="type">int</span>, <span class="built_in">len</span>, <span class="built_in">cap</span>)</span><br></pre></td></tr></table></figure>
<p>短变量声明法，声明一个切片</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slice3 := <span class="built_in">make</span>([]<span class="type">int</span>, <span class="built_in">len</span>)</span><br></pre></td></tr></table></figure>
<p>从数组中直接切出一个切片，区间为 [startIndex, endIndex)，左闭右开。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s := arr[startIndex:endIndex]</span><br><span class="line"><span class="comment">//省略startIndex表示从0开始切，省略endIndex表示切到结尾，两者可以都省略。</span></span><br><span class="line"><span class="comment">//从arr中切出的切片s本质是使用指针指向arr的位置，所以修改切片s时可以修改到数组arr。</span></span><br></pre></td></tr></table></figure>
<h2 id="函数"><a class="markdownIt-Anchor" href="#函数">#</a> <mark>函数</mark></h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">func 函数名(参数列表) (返回值)&#123;</span></span><br><span class="line"><span class="comment">    函数体</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//案例1，空参数，空返回：</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sayHello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 案例2，固定参数：</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">cout</span><span class="params">(str <span class="type">string</span>)</span></span> (ret <span class="type">bool</span>) &#123;</span><br><span class="line">	fmt.Println(str)</span><br><span class="line">	ret = <span class="literal">true</span></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 案例3，可变参数：</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">intSum</span><span class="params">(num ...<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;<span class="comment">//使用...来表示可变参数</span></span><br><span class="line">    <span class="comment">//可变参数可以与固定参数同时出现，但必须置后，例如：a int, b ...int</span></span><br><span class="line">	ret := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> _, arg := <span class="keyword">range</span> num &#123;</span><br><span class="line">		ret = ret + arg</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//案例4，多个返回值：</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">calc</span><span class="params">(a, b <span class="type">int</span>)</span></span>(sum, sub <span class="type">int</span>)&#123;</span><br><span class="line">    <span class="comment">//当a,b的类型相同时，可以进行简写，sum和sub同理</span></span><br><span class="line">    sum = a + b</span><br><span class="line">    sub = a - b</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	sayHello()</span><br><span class="line">	ok := cout(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">	fmt.Println(ok)</span><br><span class="line">	<span class="comment">//可变参数</span></span><br><span class="line">	fmt.Println(intSum(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">	fmt.Println(intSum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>))</span><br><span class="line">    <span class="comment">//忽略返回的sum，仅接受sub并打印</span></span><br><span class="line">	_, sub := calc(<span class="number">20</span>, <span class="number">10</span>)</span><br><span class="line">	fmt.Println(sub)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Go 语言的函数中并不存在默认参数。</p>
<h2 id="函数指针与回调函数"><a class="markdownIt-Anchor" href="#函数指针与回调函数">#</a> 函数指针与回调函数</h2>
<p>与 C 语言的函数指针和回调函数类似，写个案例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(x, y <span class="type">int</span>)</span></span> <span class="type">int</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">calc</span><span class="params">(x, y <span class="type">int</span>, op <span class="keyword">func</span>(<span class="type">int</span>, <span class="type">int</span>)</span></span> <span class="type">int</span>) <span class="type">int</span>&#123;</span><br><span class="line">    <span class="comment">//这是一个回调函数，参数op是一个函数，该函数的参数列表为两个int类型，返回值是int类型</span></span><br><span class="line">    <span class="keyword">return</span> op(x, y)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    v := add<span class="comment">//函数指针</span></span><br><span class="line">    v(<span class="number">1</span>, <span class="number">2</span>)<span class="comment">//使用函数指针调用函数</span></span><br><span class="line">    fmt.Println(calc(<span class="number">100</span>, <span class="number">200</span>, add))<span class="comment">//调用回调函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="defer延迟执行"><a class="markdownIt-Anchor" href="#defer延迟执行">#</a> defer: 延迟执行</h2>
<p>defer 语句会在函数将要结束时才执行，具有延迟调用的特性 (类似于析构)。</p>
<p>其采用栈结构，例如：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;Start...&quot;</span>)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="number">1</span>)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="number">2</span>)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="number">3</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;End...&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后输出结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Start...</span><br><span class="line">End...</span><br><span class="line">3</span><br><span class="line">2</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p>defer 通常用于处理资源释放问题，例如资源清理，文件关闭，解锁及记录时间等。</p>
<h2 id="匿名函数与闭包"><a class="markdownIt-Anchor" href="#匿名函数与闭包">#</a> <mark>匿名函数与闭包</mark></h2>
<p>匿名函数，懂的都懂。与函数唯一的区别在于不写名字，例如：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">	&#125;() <span class="comment">//结尾使用()调用匿名函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>闭包 = 函数 + 外层变量调用，举个例子：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">a</span><span class="params">(name <span class="type">string</span>)</span></span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//定义一个函数a，其需要一个类型为string的name参数，返回值是一个函数</span></span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;Hello &quot;</span>, name)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := a(<span class="string">&quot;张三&quot;</span>)</span><br><span class="line">	r()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，在这个示例中，函数 a 中的匿名函数调用到了它外层的函数 a 的变量，这样的使用方式叫做闭包。</p>
<p>再来看看示例 2：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CheckSuffix</span><span class="params">(suffix <span class="type">string</span>)</span></span> <span class="function"><span class="keyword">func</span><span class="params">(file <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">    <span class="comment">//定义一个函数CheckSuffix用于检测文件名后缀，该函数需要一个suffix(后缀)的string参数</span></span><br><span class="line">    <span class="comment">//其返回值为一个函数，返回值函数需要一个file(文件)的string参数，该函数返回值为string类型</span></span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(file <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">        <span class="comment">//使用strings提供的HasSuffix检测file的后缀是否是suffix，如果是，则返回true，不是则返回false</span></span><br><span class="line">		<span class="keyword">if</span> !strings.HasSuffix(file, suffix) &#123;</span><br><span class="line">            <span class="comment">//如果后缀不对，则将其添加后缀再返回</span></span><br><span class="line">			<span class="keyword">return</span> file + suffix</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="comment">//如果后缀正确，则直接返回file即可</span></span><br><span class="line">		<span class="keyword">return</span> file</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//测试调用</span></span><br><span class="line">	r := CheckSuffix(<span class="string">&quot;.txt&quot;</span>)</span><br><span class="line">	ret := r(<span class="string">&quot;张三&quot;</span>)</span><br><span class="line">	fmt.Println(ret)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同样的，对于函数 CheckSuffix 中的匿名函数，其也调用了外层的变量，那么这就是一个闭包的使用。</p>
<p>需要注意，内部的匿名函数是可以修改到外层变量的，如果我要这样使用：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CheckSuffix</span><span class="params">(suffix <span class="type">string</span>)</span></span> <span class="function"><span class="keyword">func</span><span class="params">(file, suf <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">	<span class="comment">//定义一个函数CheckSuffix用于检测文件名后缀，该函数需要一个suffix(后缀)的string参数</span></span><br><span class="line">	<span class="comment">//其返回值为一个函数，返回值函数需要一个file(文件)的string参数，该函数返回值为string类型</span></span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(file, suf <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">		<span class="comment">//改变代码，变量suf，如果suf是以.为开头的string，那么将suf的值赋给suffix</span></span><br><span class="line">		<span class="keyword">if</span> strings.HasPrefix(suf, <span class="string">&quot;.&quot;</span>) &#123;</span><br><span class="line">			suffix = suf</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//使用strings提供的HasSuffix检测file的后缀是否是suffix，如果是，则返回true，不是则返回false</span></span><br><span class="line">		<span class="keyword">if</span> !strings.HasSuffix(file, suffix) &#123;</span><br><span class="line">			<span class="comment">//如果后缀不对，则将其添加后缀再返回</span></span><br><span class="line">			<span class="keyword">return</span> file + suffix</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//如果后缀正确，则直接返回file即可</span></span><br><span class="line">		<span class="keyword">return</span> file</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//测试调用</span></span><br><span class="line">	r := CheckSuffix(<span class="string">&quot;.txt&quot;</span>)</span><br><span class="line">	ret := r(<span class="string">&quot;张三&quot;</span>, <span class="string">&quot;.docx&quot;</span>)</span><br><span class="line">	ret2 := r(<span class="string">&quot;李四&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">	fmt.Println(ret, ret2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以发现，输出结果为</p>
<p>张三.docx   李四.docx</p>
<p>也就是说，对于 suffix 的修改是持续生效的，并非只作用于匿名函数内部</p>
<p>如果用 lambda 表达式来说明，那么它应该相当于 [&amp;](我个人推测)</p>
<h2 id="panic与recover"><a class="markdownIt-Anchor" href="#panic与recover">#</a> panic 与 recover</h2>
<p>Go 语言追求简洁优雅，所以，Go 语言不支持传统的 try…catch…finally 这种异常，因为 Go 语言的设计者们认为，将异常与控制结构混在一起会很容易使得代码变得混乱。因为开发者很容易滥用异常，甚至一个小小的错误都抛出一个异常。在 Go 语言中，使用多值返回来返回错误。不要用异常代替错误，更不要用来控制流程。</p>
<p>panic 与 recover 是 Go 的两个内置函数，这两个内置函数用于处理 Go 运行时的错误，panic 用于主动抛出错误，recover 用来捕获 panic 抛出的错误。</p>
<p>其中 recover 通常搭配 defer 使用，例如：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">a</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;Hello in a&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">b</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//defer recover需要写在pannic的前面，否则会报错</span></span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		err := <span class="built_in">recover</span>()<span class="comment">//使用recover捕获错误</span></span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line">	<span class="built_in">panic</span>(<span class="string">&quot;panic in b&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">c</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;Hello in c&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//测试调用</span></span><br><span class="line">	a()</span><br><span class="line">	b()</span><br><span class="line">	c()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="指针与c语言基本无异不再赘述"><a class="markdownIt-Anchor" href="#指针与c语言基本无异不再赘述">#</a> 指针与 C 语言基本无异，不再赘述</h2>
<h2 id="type"><a class="markdownIt-Anchor" href="#type">#</a> type</h2>
<p>作用差不多相当于 typedef，使用如下</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义类型</span></span><br><span class="line"><span class="keyword">type</span> MyInt <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 给int取一个别名叫Int</span></span><br><span class="line"><span class="keyword">type</span> Int = <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> a Int</span><br><span class="line">	a = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> b MyInt</span><br><span class="line">	b = <span class="number">20</span></span><br><span class="line">	fmt.Println(a, b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="结构体"><a class="markdownIt-Anchor" href="#结构体">#</a> <mark>结构体</mark></h2>
<h3 id="定义结构体"><a class="markdownIt-Anchor" href="#定义结构体">#</a> 定义结构体</h3>
<p>使用方法和 C 语言类似，使用 type 和 struct 关键字来定义一个结构体，如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义人类结构体</span></span><br><span class="line"><span class="keyword">type</span> people <span class="keyword">struct</span> &#123;</span><br><span class="line">	name <span class="type">string</span></span><br><span class="line">	age  <span class="type">int8</span></span><br><span class="line">	city <span class="type">string</span></span><br><span class="line">	<span class="comment">//这里也可以写成  name, city string 类似于函数的参数类型简写</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//实例化</span></span><br><span class="line">	<span class="keyword">var</span> p people</span><br><span class="line">	p.name = <span class="string">&quot;张三&quot;</span></span><br><span class="line">	p.age = <span class="number">18</span></span><br><span class="line">	p.city = <span class="string">&quot;北京&quot;</span></span><br><span class="line">	fmt.Printf(<span class="string">&quot;p=%v\n&quot;</span>, p)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//匿名结构体：</span></span><br><span class="line">	<span class="keyword">var</span> user <span class="keyword">struct</span> &#123;</span><br><span class="line">		name    <span class="type">string</span></span><br><span class="line">		married <span class="type">bool</span></span><br><span class="line">	&#125;</span><br><span class="line">	user.name = <span class="string">&quot;李四&quot;</span></span><br><span class="line">	user.married = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//结构体指针</span></span><br><span class="line">	<span class="keyword">var</span> p2 = <span class="built_in">new</span>(people)</span><br><span class="line">	<span class="comment">//正常的结构体指针成员调用方式：</span></span><br><span class="line">	(*p2).name = <span class="string">&quot;王五&quot;</span></span><br><span class="line">	<span class="comment">//对于结构体指针，Go语言可以直接使用星号调用其成员，类似于-&gt;</span></span><br><span class="line">	p2.age = <span class="number">18</span></span><br><span class="line">	p2.city = <span class="string">&quot;上海&quot;</span></span><br><span class="line">	fmt.Printf(<span class="string">&quot;%v\n&quot;</span>, p2)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//取结构体的地址进行实例化：</span></span><br><span class="line">	p3 := &amp;people&#123;&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%v\n&quot;</span>, p3)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="结构体初始化"><a class="markdownIt-Anchor" href="#结构体初始化">#</a> 结构体初始化</h3>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义人类结构体</span></span><br><span class="line"><span class="keyword">type</span> people <span class="keyword">struct</span> &#123;</span><br><span class="line">	name, city <span class="type">string</span></span><br><span class="line">	age        <span class="type">int8</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//1.键值对初始化：</span></span><br><span class="line">	p := people&#123;</span><br><span class="line">		name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">		age:  <span class="number">18</span>, <span class="comment">//需要注意，每一个值后面都需要加逗号，最后一行也是，否则会报错，city会被初始化为空串</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%#v\n&quot;</span>, p)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2.值的列表进行初始化</span></span><br><span class="line">	p2 := &amp;people&#123; <span class="comment">//列表初始化时，需要值和结构体成员一一对应</span></span><br><span class="line">		<span class="string">&quot;李四&quot;</span>,</span><br><span class="line">		<span class="string">&quot;北京&quot;</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%#v\n&quot;</span>, p2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="构造函数"><a class="markdownIt-Anchor" href="#构造函数">#</a> 构造函数</h3>
<p>Go 语言的结构体没有构造函数，但是可以自己实现。例如，实现 people 的构造函数：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造函数</span></span><br><span class="line"><span class="keyword">type</span> people <span class="keyword">struct</span> &#123;</span><br><span class="line">	name, city <span class="type">string</span></span><br><span class="line">	age        <span class="type">int8</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newPeople</span><span class="params">(name, city <span class="type">string</span>, age <span class="type">int8</span>)</span></span> *people &#123;</span><br><span class="line">	<span class="comment">//结构体是值类型，所以返回指针更节省空间</span></span><br><span class="line">	<span class="keyword">return</span> &amp;people&#123;</span><br><span class="line">		name: name,</span><br><span class="line">		city: city,</span><br><span class="line">		age:  age,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p1 := newPeople(<span class="string">&quot;张三哥&quot;</span>, <span class="string">&quot;北京&quot;</span>, <span class="type">int8</span>(<span class="number">18</span>))</span><br><span class="line">	fmt.Printf(<span class="string">&quot;type:%T value:%#v\n&quot;</span>, p1, p1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="匿名结构体与结构体嵌套"><a class="markdownIt-Anchor" href="#匿名结构体与结构体嵌套">#</a> 匿名结构体与结构体嵌套</h3>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//Go语言结构体中的字段可以匿名</span></span><br><span class="line">	<span class="type">string</span></span><br><span class="line">	<span class="type">int8</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p1 := Person&#123;</span><br><span class="line">		<span class="string">&quot;小王子&quot;</span>,</span><br><span class="line">		<span class="number">18</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(p1)</span><br><span class="line">	<span class="comment">//访问时通过其类型进行访问，但需要注意，使用匿名字段时需要避免类型重复</span></span><br><span class="line">	fmt.Println(p1.<span class="type">string</span>, p1.<span class="type">int8</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用匿名结构体，对结构体进行嵌套</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Address struct</span></span><br><span class="line"><span class="keyword">type</span> Address <span class="keyword">struct</span> &#123;</span><br><span class="line">	province, city <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Person stuct</span></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	name, gender <span class="type">string</span></span><br><span class="line">	age          <span class="type">int8</span></span><br><span class="line">	<span class="comment">//嵌套另外一个结构体</span></span><br><span class="line">	<span class="comment">//address      Address</span></span><br><span class="line">	<span class="comment">//匿名嵌套一个结构体</span></span><br><span class="line">	Address</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p1 := Person&#123;</span><br><span class="line">		name:   <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">		gender: <span class="string">&quot;男&quot;</span>,</span><br><span class="line">		age:    <span class="number">18</span>,</span><br><span class="line">		Address: Address&#123;</span><br><span class="line">			province: <span class="string">&quot;河北&quot;</span>,</span><br><span class="line">			city:     <span class="string">&quot;石家庄&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(p1)</span><br><span class="line">	<span class="comment">//使用匿名结构体嵌套，调用匿名结构体中的字段时，会首先在结构体中检索</span></span><br><span class="line">	<span class="comment">//若未检索到该字段，则会去匿名结构体中进行查找</span></span><br><span class="line">	fmt.Println(p1.name, p1.province)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="方法和接收者"><a class="markdownIt-Anchor" href="#方法和接收者">#</a> 方法和接收者</h3>
<p>Go 语言中方法 (Method) 是一种作用域特定类型变量的函数</p>
<p>这种特定类型变量叫做接收者 (Receiver)</p>
<p>接收者的概念就类似于其他语言中的 this 或者 self</p>
<p>方法的定义格式如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(接收者变量 接收者类型)</span></span> 方法名(参数列表)(返回此参数)&#123;</span><br><span class="line">	函数体</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 一个结构体，以大写字母开头，那么它通常是对外部可见的，最好补充注释</span></span><br><span class="line"><span class="comment">// Person is a struct</span></span><br><span class="line"><span class="keyword">type</span> People <span class="keyword">struct</span> &#123;</span><br><span class="line">	name <span class="type">string</span></span><br><span class="line">	age  <span class="type">int8</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造函数</span></span><br><span class="line"><span class="comment">// NewPeople is a constructor of type People</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewPeople</span><span class="params">(name <span class="type">string</span>, age <span class="type">int8</span>)</span></span> *People &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;People&#123;</span><br><span class="line">		name: name,</span><br><span class="line">		age:  age,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义方法</span></span><br><span class="line"><span class="comment">// Dream is a method of type People</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p People)</span></span> Dream() &#123;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%s的梦想是学好Go语言！\n&quot;</span>, p.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SetAge is used to modify the age of People types</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *People)</span></span> SetAge(newAge <span class="type">int8</span>) &#123;</span><br><span class="line">	p.age = newAge</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p1 := NewPeople(<span class="string">&quot;张三&quot;</span>, <span class="type">int8</span>(<span class="number">18</span>))</span><br><span class="line">	<span class="comment">//正常写法：(*p1).Dream()</span></span><br><span class="line">	<span class="comment">//也可以写为：</span></span><br><span class="line">	p1.Dream()</span><br><span class="line"></span><br><span class="line">	fmt.Println(p1.age)</span><br><span class="line">	p1.SetAge(<span class="type">int8</span>(<span class="number">24</span>))</span><br><span class="line">	fmt.Println(p1.age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Go 语言中，接收者类型可以是任何类型，不仅仅是结构体，任何类型都可以拥有方法。</p>
<p><strong>但是只能给自己的包中的类型定义方法。</strong></p>
<p>可以通过 type 关键字，基于 int 定义一个新的 MyInt 类型，然后为其定义方法。</p>
<h3 id="结构体继承"><a class="markdownIt-Anchor" href="#结构体继承">#</a> 结构体继承</h3>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用结构体实现类似继承的效果</span></span><br><span class="line"><span class="comment">// 基类Animal</span></span><br><span class="line"><span class="keyword">type</span> Animal <span class="keyword">struct</span> &#123;</span><br><span class="line">	name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Animal的方法move</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *Animal)</span></span> move() &#123;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%s会动\n&quot;</span>, a.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 派生类Dog</span></span><br><span class="line"><span class="keyword">type</span> Dog <span class="keyword">struct</span> &#123;</span><br><span class="line">	Feet <span class="type">int8</span></span><br><span class="line">	<span class="comment">//继承基类Animal</span></span><br><span class="line">	*Animal</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Dog的方法bark</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *Dog)</span></span> bark() &#123;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%s会汪汪汪\n&quot;</span>, d.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	d1 := &amp;Dog&#123;</span><br><span class="line">		Feet: <span class="number">4</span>,</span><br><span class="line">		Animal: &amp;Animal&#123;</span><br><span class="line">			name: <span class="string">&quot;旺财&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">	d1.bark()</span><br><span class="line">	<span class="comment">//通过子类调用其父类的方法</span></span><br><span class="line">	d1.move()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="结构体字段的可见性"><a class="markdownIt-Anchor" href="#结构体字段的可见性">#</a> 结构体字段的可见性</h3>
<p>Go 语言的结构体字段，如果开头字母是大写的，那么就是公开的，可以被外部访问的 (类似于 public)</p>
<p>如果开头字母是小写的，那么就是私有的，只能被定义该结构体的包中使用 (类似于 protected)</p>
<h3 id="结构体与json序列化"><a class="markdownIt-Anchor" href="#结构体与json序列化">#</a> 结构体与 JSON 序列化</h3>
<p>JSON (JavaScript Object Notation) 是一种轻量级的数据交换格式。易于人阅读和编写。同时也易于机器解析和生成。</p>
<p>JSON 键值对是用来保存 JS 对象的一种方式：</p>
<ol>
<li>键 / 值对组合中的键名写在前面，并用双引号包裹</li>
<li>使用冒号分隔</li>
<li>然后紧接着值</li>
<li>多个键值之间用逗号分隔</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> student <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id   <span class="type">int</span></span><br><span class="line">	Name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newStudent</span><span class="params">(id <span class="type">int</span>, name <span class="type">string</span>)</span></span> student &#123;</span><br><span class="line">	<span class="keyword">return</span> student&#123;</span><br><span class="line">		Id:   id,</span><br><span class="line">		Name: name,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> class <span class="keyword">struct</span> &#123;</span><br><span class="line">	Title   <span class="type">string</span></span><br><span class="line">	Student []student</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//创建一个班级变量c1</span></span><br><span class="line">	c1 := class&#123;</span><br><span class="line">		Title:   <span class="string">&quot;火箭班&quot;</span>,</span><br><span class="line">		Student: <span class="built_in">make</span>([]student, <span class="number">0</span>, <span class="number">20</span>),</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//往班级c1中添加学生</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		tmpStu := newStudent(i, fmt.Sprintf(<span class="string">&quot;stu%02d&quot;</span>, i))</span><br><span class="line">		c1.Student = <span class="built_in">append</span>(c1.Student, tmpStu)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//fmt.Printf(&quot;%#v\n&quot;, c1)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//JSON序列化：Go语言中的数据-&gt;JSON格式的字符串</span></span><br><span class="line">	<span class="comment">//使用json包中提供的marshal方法进行json序列化</span></span><br><span class="line">	<span class="comment">//marshal返回两个值，第一个是data，第二个是err信息</span></span><br><span class="line">	<span class="comment">//marshal需要一个参数，即需要序列化的数据</span></span><br><span class="line">	data, err := json.Marshal(c1)</span><br><span class="line">	<span class="comment">//对返回的err进行判断，如果err不为空，那么打印err信息，并退出程序</span></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;json marshal failed, err:&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//打印序列化后的数据进行确认</span></span><br><span class="line">	fmt.Printf(<span class="string">&quot;%T\n&quot;</span>, data)</span><br><span class="line">	<span class="comment">//fmt.Printf(&quot;%s\n&quot;, data)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//JSON反序列化：JSON格式的字符串-&gt;Go语言中的数据</span></span><br><span class="line">	jsonStr := <span class="string">`&#123;&quot;Title&quot;:&quot;火箭班&quot;,&quot;Student&quot;:[&#123;&quot;Id&quot;:0,&quot;Name&quot;:&quot;stu00&quot;&#125;,&#123;&quot;Id&quot;:1,&quot;Name&quot;:&quot;stu01&quot;&#125;,&#123;&quot;Id&quot;:2,&quot;Name&quot;:&quot;stu02&quot;&#125;]&#125;`</span></span><br><span class="line">	<span class="comment">//使用c2对转换后的数据进行接受</span></span><br><span class="line">	<span class="keyword">var</span> c2 class</span><br><span class="line">	<span class="comment">//使用json包中的Unmarshal方法，对其进行反序列化</span></span><br><span class="line">	<span class="comment">//所需参数为原始json字符串的字节流，与存储容器</span></span><br><span class="line">	<span class="comment">//将jsonStr强转为字节流，取c2地址进行指针传递以使其能够存储</span></span><br><span class="line">	<span class="comment">//返回一个值为err信息，需要接收</span></span><br><span class="line">	err = json.Unmarshal([]<span class="type">byte</span>(jsonStr), &amp;c2)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="comment">//对err进行判断</span></span><br><span class="line">		fmt.Println(<span class="string">&quot;json unmarshal failed, err:&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%#v\n&quot;</span>, c2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>需要注意的是，如果结构体中的字段首字母变为小写，那么其将对外不可见。</p>
<p>则使用 json 包中的方法时，json 的方法并不能够调用其字段，会导致错误。</p>
<h3 id="结构体标签tag"><a class="markdownIt-Anchor" href="#结构体标签tag">#</a> 结构体标签 (Tag)</h3>
<p>Tag 用于解决其他语言字段首字母小写与 Go 语言字段首字母大写不兼容的问题</p>
<p>Tag 是结构体的元信息，可以在运行的时候通过反射的机制读取出来。</p>
<p>Tag 在结构体字段的后方定义，由一对反引号 (ESC 下面那个键) 包裹起来，具体格式如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//每对键值对中间用空格分隔</span></span><br><span class="line"><span class="string">`key1:&quot;value1&quot; key2:&quot;value2&quot;`</span></span><br></pre></td></tr></table></figure>
<p>注意：为结构体编写 Tag 时，必须严格遵守键值对的规则。结构体标签的解析代码容错能力很差，一旦格式写错，编译和运行时都不会提示任何错误，通过反射也无法正常取值。</p>
<p>例如：不要在 key 和 value 之间添加空格</p>
<p>具体使用如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> class <span class="keyword">struct</span> &#123;</span><br><span class="line">	Title   <span class="type">string</span> <span class="string">`json:&quot;title&quot;`</span></span><br><span class="line">	Student []student</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这样就可以使class在json序列化时，字段名被转换为title</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="小练习"><a class="markdownIt-Anchor" href="#小练习">#</a> 小练习：</h2>
<p>实现学员信息管理系统，包含以下功能:</p>
<ol>
<li>添加学员信息</li>
<li>编辑学员信息</li>
<li>展示所有学员信息</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.go</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//学员信息管理系统</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//1.添加学员信息</span></span><br><span class="line"><span class="comment">//2.编辑学员信息</span></span><br><span class="line"><span class="comment">//3.展示所有学员信息</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">showMenu</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;欢迎来到学员信息管理系统&quot;</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;1.添加学员&quot;</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;2.编辑学员信息&quot;</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;3.展示所有学员信息&quot;</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;4.退出系统&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get user input infomation of student</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getNewStu</span><span class="params">()</span></span> *student &#123;</span><br><span class="line">	<span class="keyword">var</span> id, name, class <span class="type">string</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;请按要求输入学员信息&quot;</span>)</span><br><span class="line">	fmt.Print(<span class="string">&quot;请输入学员的学号：&quot;</span>)</span><br><span class="line">	fmt.Scanln(&amp;id)</span><br><span class="line"></span><br><span class="line">	fmt.Print(<span class="string">&quot;请输入学员的姓名：&quot;</span>)</span><br><span class="line">	fmt.Scanln(&amp;name)</span><br><span class="line"></span><br><span class="line">	fmt.Print(<span class="string">&quot;请输入学员的班级：&quot;</span>)</span><br><span class="line">	fmt.Scanln(&amp;class)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> newStudent(id, name, class)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	sms := newStuManSys()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="comment">//1.打印系统菜单</span></span><br><span class="line">		showMenu()</span><br><span class="line">		fmt.Println(<span class="string">&quot;请输入你要操作的序号&quot;</span>)</span><br><span class="line"></span><br><span class="line">		<span class="comment">//2.等待用户选择执行的选项</span></span><br><span class="line">		<span class="keyword">var</span> choice <span class="type">int</span></span><br><span class="line">		fmt.Scanf(<span class="string">&quot;%d\n&quot;</span>, &amp;choice)</span><br><span class="line"></span><br><span class="line">		<span class="comment">//3.执行用户选择的选项</span></span><br><span class="line">		<span class="keyword">switch</span> choice &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">			sms.addStu(getNewStu())</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">			sms.editStu(getNewStu())</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">			sms.showStu()</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">			<span class="comment">//退出</span></span><br><span class="line">			os.Exit(<span class="number">0</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//student.go</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//student struct</span></span><br><span class="line"><span class="keyword">type</span> student <span class="keyword">struct</span> &#123;</span><br><span class="line">	id, class, name <span class="type">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//constructor of student</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newStudent</span><span class="params">(id, name, class <span class="type">string</span>)</span></span> *student &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;student&#123;</span><br><span class="line">		id:    id,</span><br><span class="line">		name:  name,</span><br><span class="line">		class: class,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//studentManageSystem struct</span></span><br><span class="line"><span class="keyword">type</span> stuManSys <span class="keyword">struct</span> &#123;</span><br><span class="line">	allStudents []*student</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//constructor of stuManSys</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newStuManSys</span><span class="params">()</span></span> *stuManSys &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;stuManSys&#123;</span><br><span class="line">		allStudents: <span class="built_in">make</span>([]*student, <span class="number">0</span>, <span class="number">100</span>),</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Method of adding stu belonging to stuManSys</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *stuManSys)</span></span> addStu(newStu *student) &#123;</span><br><span class="line">	s.allStudents = <span class="built_in">append</span>(s.allStudents, newStu)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Method of editing stu belonging to stuManSys</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *stuManSys)</span></span> editStu(newStu *student) &#123;</span><br><span class="line">	<span class="keyword">for</span> i, v := <span class="keyword">range</span> s.allStudents &#123;</span><br><span class="line">		<span class="keyword">if</span> newStu.id == v.id &#123;</span><br><span class="line">			s.allStudents[i] = newStu</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;输入学号有误&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Method of showing stu belonging to stuManSys</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *stuManSys)</span></span> showStu() &#123;</span><br><span class="line">	<span class="keyword">for</span> _, i := <span class="keyword">range</span> s.allStudents &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;学号:%s\t姓名:%s\t班级:%s\n&quot;</span>, i.id, i.name, i.class)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="go语言-包package"><a class="markdownIt-Anchor" href="#go语言-包package">#</a> <mark>Go 语言 - 包 (package)</mark></h1>
<h2 id="介绍"><a class="markdownIt-Anchor" href="#介绍">#</a> 介绍</h2>
<p>包 (package) 是多个 Go 源码的集合，是一种高级的代码复用方案，Go 语言提供了很多内置包，如 fmt、os、io 等</p>
<h2 id="定义包"><a class="markdownIt-Anchor" href="#定义包">#</a> 定义包</h2>
<p>可以根据自己的需要创建自己的包。</p>
<p>一个包可以简单的理解为一个存放.go 文件的文件夹。</p>
<p>该文件夹下面的所有 go 文件都要在代码的第一行添加如下代码，声明该文件归属的包。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> 包名</span><br></pre></td></tr></table></figure>
<p>注意事项：</p>
<ul>
<li>一个文件夹下面只能有一个包，同样一个包的文件不能在多个文件夹下</li>
<li>包名可以和文件夹名不同，包名不能包含 - 符号</li>
<li>包名为 main 的包为应用程序的入口包，编译不包含 main 包的源代码时不会得到可执行文件</li>
</ul>
<h2 id="可见性"><a class="markdownIt-Anchor" href="#可见性">#</a> 可见性</h2>
<p>如果想在一个包中引用另外一个包里的标识符 (如变量、常量、类型、函数等) 时，该标识符必须是对外可见的 (public)</p>
<p>在 Go 语言中只需要将标识符的首字母大写，就可以让标识符对外可见了</p>
<p><strong>示例：</strong></p>
<p>文件路径：/GoLearn/package_demo/calc/add.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> calc</span><br><span class="line"></span><br><span class="line"><span class="comment">// add funciton</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Add</span><span class="params">(x, y <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> x + y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>文件路径：/GoLearn/package_demo/main/main.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;GoLearn/package_demo/calc&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(calc.Add(<span class="number">10</span>, <span class="number">20</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也可以给导入的包起别名：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">//可以给导入的包起别名，来规避包名相同的冲突</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	Another_name <span class="string">&quot;GoLearn/package_demo/calc&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(Another_name.Add(<span class="number">10</span>, <span class="number">20</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="init函数与匿名包"><a class="markdownIt-Anchor" href="#init函数与匿名包">#</a> init 函数与匿名包</h2>
<p>init 函数是一种特殊的函数，它没有参数也没有返回值</p>
<p>在包被导入的时候会自动调用</p>
<p>示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;Hello!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当仅需要执行包的 init 函数而不需要其内部的数据时，可以使用匿名包的形式，格式如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _ <span class="string">&quot;包的路径&quot;</span></span><br></pre></td></tr></table></figure>
<p>导入包与 init 函数的调用符合栈结构</p>
<p>即先导入者后 init，而 main 包是最先被导入的，所以它的 init 函数会被最后调用</p>
<h1 id="go语言-接口interface"><a class="markdownIt-Anchor" href="#go语言-接口interface">#</a> <mark>Go 语言 - 接口 (interface)</mark></h1>
<p>Go 语言中的接口是一种抽象的类型</p>
<p>一个类型可以实现多个接口，一个接口也可以对应多种类型，二者之间是多对多的关系</p>
<p>接口实现示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//interface</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> usbFlashDisk <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u usbFlashDisk)</span></span> usbLink() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;U盘已连接&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> phone <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p phone)</span></span> usbLink() &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;手机已连接&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个抽象的类型，只要实现了usbLink()这个方法的类型都可以称为usb类型</span></span><br><span class="line"><span class="keyword">type</span> usb <span class="keyword">interface</span> &#123;</span><br><span class="line">	usbLink()<span class="comment">//有参数和返回值的方法，在这里也写上参数和返回值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接口不管你是什么类型，只管你要实现什么方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">link</span><span class="params">(arg usb)</span></span> &#123;</span><br><span class="line">	arg.usbLink()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	u1 := usbFlashDisk&#123;&#125;</span><br><span class="line">	link(u1)</span><br><span class="line">	p1 := phone&#123;&#125;</span><br><span class="line">	link(p1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当一个接口不要求实现任何方法时，该接口是一个空接口</p>
<p>任意结构都满足空接口</p>
<h2 id="值接收者与指针接收者关于接口的差异"><a class="markdownIt-Anchor" href="#值接收者与指针接收者关于接口的差异">#</a> 值接收者与指针接收者关于接口的差异</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> mover <span class="keyword">interface</span> &#123;</span><br><span class="line">	move()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span> &#123;</span><br><span class="line">	name <span class="type">string</span></span><br><span class="line">	age  <span class="type">int8</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用值接收者实现接口：类型的值和类型的指针都能保存到接口变量中</span></span><br><span class="line"><span class="comment">//func (p person) move() &#123;</span></span><br><span class="line"><span class="comment">//	fmt.Printf(&quot;%s在跑\n&quot;, p.name)</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用指针接收者实现接口：只有类型指针能够保存到接口变量中</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *person)</span></span> move() &#123;</span><br><span class="line">	s := <span class="string">&quot;在跑&quot;</span></span><br><span class="line">	fmt.Println(p.name, s)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> m mover</span><br><span class="line">	p1 := &amp;person&#123;</span><br><span class="line">		name: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">		age:  <span class="number">18</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	m = p1</span><br><span class="line">	m.move()</span><br><span class="line">	fmt.Println(m)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="接口内部存储"><a class="markdownIt-Anchor" href="#接口内部存储">#</a> 接口内部存储</h2>
<p>接口内部存储分为两部分：</p>
<ul>
<li>一部分保存其动态类型，用于记录存储变量的类型。</li>
<li>另一部分保存其动态值，用于记录存储变量的值。</li>
</ul>
<p>类型断言：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//可以给一个接口存储变量的类型进行断言：</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="comment">//定义空接口</span></span><br><span class="line"><span class="keyword">type</span> xxx <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x xxx</span><br><span class="line">    <span class="comment">//任意类型都满足空接口，所以可以传入bool类型</span></span><br><span class="line">    x = <span class="literal">false</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//使用x.(type)来断言x中保存的变量类型</span></span><br><span class="line">    <span class="comment">//会返回两个值，ret是x的变量值，ok是一个布尔类型，true时表示断言正确，false时表示断言错误</span></span><br><span class="line">    <span class="comment">//ok=false时，ret=string的零值</span></span><br><span class="line">    ret, ok := x.(<span class="type">string</span>)</span><br><span class="line">    <span class="keyword">if</span> !ok &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;不是string类型&quot;</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;是字符串类型&quot;</span>, ret)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用 switch 进行类型断言：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以给一个接口存储变量的类型进行断言：</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义空接口</span></span><br><span class="line"><span class="keyword">type</span> xxx <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> x xxx</span><br><span class="line">	x = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> v := x.(<span class="keyword">type</span>) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="type">string</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;是字符串类型，value：&quot;</span>, v)</span><br><span class="line">	<span class="keyword">case</span> <span class="type">bool</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;是布尔类型，value：&quot;</span>, v)</span><br><span class="line">	<span class="keyword">case</span> <span class="type">int</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;是int类型，value：&quot;</span>, v)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;猜不到了，value：&quot;</span>, v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="go语言标准库"><a class="markdownIt-Anchor" href="#go语言标准库">#</a> <mark>Go 语言标准库</mark></h1>
<h2 id="time包"><a class="markdownIt-Anchor" href="#time包">#</a> time 包</h2>
<p>time 包提供的部分方法：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">now := time.Now() <span class="comment">//获取当前时间，返回值是一个对象</span></span><br><span class="line">now.Unix() <span class="comment">//获取时间戳</span></span><br><span class="line">now.UnixNano() <span class="comment">//纳秒时间戳</span></span><br><span class="line">time.Unix() <span class="comment">//时间戳转换为时间</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//可以由结构Time的对象调用(比如now)，增加d(Duration是一种时间间隔的枚举类型，规定了时、分、秒等时间间隔)，返回一个Time类型</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t Time)</span></span>Add(d Duration) Time</span><br><span class="line"><span class="comment">//可以由结构Time的对象调用(比如now)，减去另一个Time对象，求出其时间间隔(Duration类型)，并返回</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t Time)</span></span>Sub(u Time) Duration</span><br><span class="line"><span class="comment">//判断两个时间是否相等</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t Time)</span></span>Equal(u Time) <span class="type">bool</span></span><br><span class="line"><span class="comment">//判断t是否在u之前，是返回真，不是返回假</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t Time)</span></span>Before(u Time) <span class="type">bool</span></span><br><span class="line"><span class="comment">//判断t是否在u之后，是返回真，不是返回假</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t Time)</span></span>After(u Time) <span class="type">bool</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定时器</span></span><br><span class="line"><span class="comment">//使用time.Tick(d Duration)可以设置定时器，定时器本质上是一个通道(channel)</span></span><br><span class="line">tick := time.Tick(time.Second)</span><br><span class="line"></span><br><span class="line"><span class="comment">//格式化</span></span><br><span class="line"><span class="comment">//Go语言的格式化需要按照Y m d H M S为2006 01 02 15 04 05的顺序填入，不能填错</span></span><br><span class="line"><span class="comment">//maybe这个时间是go语言被创造出来的时间，可以记为2006一二三四五，但注意3是下午的15点。</span></span><br><span class="line"><span class="comment">//中间使用的分隔符号可以自行选择，可以用点或者-或者：，如下：</span></span><br><span class="line">ret1 := now.Format(<span class="string">&quot;2006-01-02 15:04:05&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//解析字符串类型的时间</span></span><br><span class="line">timeStr := <span class="string">&quot;2023/08/12 09:29:00&quot;</span></span><br><span class="line"><span class="comment">//载入时区，使用LoadLocation函数</span></span><br><span class="line"><span class="comment">//其中loc为时区，err为错误信息，需要进行判断</span></span><br><span class="line">loc, err := time.LoadLocation(<span class="string">&quot;Asia/Shanghai&quot;</span>)<span class="comment">//这里以上海为例</span></span><br><span class="line"><span class="comment">//根据时区解析字符串格式的时间</span></span><br><span class="line">timeObj, err := time.ParseInLocation(<span class="string">&quot;2006/01/02 15:04:05&quot;</span>, timeStr, loc)</span><br><span class="line"><span class="comment">//也可以使用Parse方法直接转换，会转换为UTC时间</span></span><br><span class="line">timeObj, err := time.Parse(<span class="string">&quot;2006/01/02 15:04:05&quot;</span>, timeStr)</span><br></pre></td></tr></table></figure>
<p>具体使用可以看 Go 语言 - 时间对象</p>
<h2 id="os包"><a class="markdownIt-Anchor" href="#os包">#</a> os 包</h2>
<p>os 包提供的部分方法：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以只读的形式打开路径为path的文件，返回打开的文件和错误信息，错误信息需要判断</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Open</span><span class="params">(path <span class="type">string</span>)</span></span>(*File, <span class="type">error</span>)</span><br><span class="line"><span class="comment">//以flag的模式，打开路径为path的文件，其权限为perm(Linux中的权限)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">OpenFile</span><span class="params">(path <span class="type">string</span>, flag <span class="type">int</span>, perm FileMode)</span></span>(*File, <span class="type">error</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//文件指针的方法，读取文件指针的内容，并以字节流的形式存储到b中</span></span><br><span class="line"><span class="comment">//返回值包括读取的字节数n，和错误信息err</span></span><br><span class="line"><span class="comment">//当读取到文件末尾时，错误信息err==io.EOF</span></span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(f *File)</span></span>Read(b []<span class="type">byte</span>)(n <span class="type">int</span>, err <span class="type">error</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//bufio会先将读取或写入内容写入到缓存区，然后再执行操作，NewReader返回一个对象</span></span><br><span class="line">reader := bufio.NewReader(f *File)</span><br><span class="line"><span class="comment">//调用reader对象的方法ReadString，后面的(&#x27;\n&#x27;)表示读取内容以换行符结尾，注意使用字符而非字符串</span></span><br><span class="line"><span class="comment">//返回值line为读取到的内容，是string类型，err为错误信息</span></span><br><span class="line">line, err := reader.ReadString(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//读取文件的所有内容，返回值为文件内容(字节形式)，和错误信息</span></span><br><span class="line">content, err := ioutil.ReadFile(path)<span class="comment">//该函数于Go 1.16已被废弃，相关内容转移至io包或os包</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//写入字节内容b，返回写入字节数n，和错误信息err</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *File)</span></span>Write(b []<span class="type">byte</span>)(n <span class="type">int</span>, err <span class="type">error</span>)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *File)</span></span>WriteString(s <span class="type">string</span>)(n <span class="type">int</span>, err <span class="type">error</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用bufio写入</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewWriter</span><span class="params">(w io.writer)</span></span> *Writer</span><br><span class="line"><span class="comment">//将s写入到缓冲区</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(w *Writer)</span></span>WriteString(s <span class="type">string</span>)(n <span class="type">int</span>, err <span class="type">error</span>)</span><br><span class="line"><span class="comment">//将缓冲区内容写入到磁盘</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(w *Writer)</span></span>Flush() <span class="type">error</span></span><br></pre></td></tr></table></figure>
<p>打开模式 flag 包括：</p>
<table>
<thead>
<tr>
<th style="text-align:center">模式</th>
<th style="text-align:center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">os.O_WRONLY</td>
<td style="text-align:center">只写</td>
</tr>
<tr>
<td style="text-align:center">os.O_CREATE</td>
<td style="text-align:center">创建文件</td>
</tr>
<tr>
<td style="text-align:center">os.O_RDONLY</td>
<td style="text-align:center">只读</td>
</tr>
<tr>
<td style="text-align:center">os.O_PDWR</td>
<td style="text-align:center">读写</td>
</tr>
<tr>
<td style="text-align:center">os.O_TRUNC</td>
<td style="text-align:center">重写</td>
</tr>
<tr>
<td style="text-align:center">os.O_APPEND</td>
<td style="text-align:center">追加</td>
</tr>
</tbody>
</table>
<p>perm：按照 linux 权限规定：r=4，w=2，x=1</p>
<p><strong>具体使用可以看 Go 语言 - 文件读写</strong></p>
<h2 id="sync包"><a class="markdownIt-Anchor" href="#sync包">#</a> sync 包</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sync.WaitGroup	<span class="comment">//goroutine等待队列</span></span><br><span class="line">sync.Mutex		<span class="comment">//互斥锁，详情可见并发编程-&gt;并发同步和锁-&gt;互斥锁</span></span><br><span class="line">sync.RWMutex	<span class="comment">//读写互斥锁，详情可见并发编程-&gt;并发同步和锁-&gt;读写互斥锁</span></span><br><span class="line">sync.Once		<span class="comment">//保证某段代码在并发情况下必定，且仅执行一次</span></span><br><span class="line">sync.Map		<span class="comment">//Go语言中内置的Map并不是并发安全的Map，这里提供一个并发安全的Map</span></span><br></pre></td></tr></table></figure>
<h2 id="net包"><a class="markdownIt-Anchor" href="#net包">#</a> net 包</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Listen</span><span class="params">(&quot;protocol&quot;, &quot;Port&quot;)</span></span> (Listener, <span class="type">error</span>)<span class="comment">//参数输入样例: &quot;tcp&quot;, &quot;localhost:8080&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l Listener)</span></span> Accept() (Conn, <span class="type">error</span>)<span class="comment">//开启连接</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Conn)</span></span> Close()<span class="comment">//关闭连接</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Conn)</span></span> Write(b []<span class="type">byte</span>) (n <span class="type">int</span>, err <span class="type">error</span>)<span class="comment">//以字节流的形式发送数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Dial</span><span class="params">(&quot;protocol&quot;, &quot;address&quot;)</span></span> (Conn, <span class="type">error</span>)<span class="comment">//主动向address发起连接请求</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Conn)</span></span> Read(b []<span class="type">byte</span>) (n <span class="type">int</span>, err <span class="type">error</span>)<span class="comment">//接收对方发送的以字节流形式的数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//参考输入样例：  &quot;udp&quot;, &amp;UDPAddr&#123;IP:net.IPv4(127,0,0,1),Port:8080,&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ListenUDP</span><span class="params">(&quot;protocol&quot;, *UDPAddr)</span></span> (*UDPConn, <span class="type">error</span>)</span><br><span class="line"><span class="comment">//读取传来的数据到b中，返回读取字节数n，发送地址addr和错误信息</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *UDPConn)</span></span> ReadFromUDP(b []<span class="type">byte</span>) (n <span class="type">int</span>, addr *UDPAddr, err <span class="type">error</span>)</span><br><span class="line"><span class="comment">//发送字节流b到addr</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *UDPConn)</span></span> WriteToUDP(b []<span class="type">byte</span>, addr *UDPAddr) (<span class="type">int</span>, <span class="type">error</span>)</span><br><span class="line"><span class="comment">//主动向addr发送数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DialUDP</span><span class="params">(network <span class="type">string</span>, laddr *UDPAddr, raddr *UDPAddr)</span></span> (*UDPConn, <span class="type">error</span>)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *UDPConn)</span></span> Write(b []<span class="type">byte</span>) (n <span class="type">int</span>, err <span class="type">error</span>)<span class="comment">//以字节流的形式发送数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *UDPConn)</span></span> Close()<span class="comment">//关闭连接</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *UDPConn)</span></span> ReadFromUDP(b []<span class="type">byte</span>) (n <span class="type">int</span>, err <span class="type">error</span>)<span class="comment">//接收对方发送的以字节流形式的数据</span></span><br></pre></td></tr></table></figure>
<h1 id="go语言-时间对象"><a class="markdownIt-Anchor" href="#go语言-时间对象">#</a> Go 语言 - 时间对象</h1>
<p>使用示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//获取当前时间</span></span><br><span class="line">	now := time.Now() <span class="comment">//时间对象</span></span><br><span class="line">	fmt.Println(now)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//从该时间对象中获取具体的年、月、日、时、分、秒</span></span><br><span class="line">	year := now.Year()</span><br><span class="line">	month := now.Month()</span><br><span class="line">	day := now.Day()</span><br><span class="line">	hour := now.Hour()</span><br><span class="line">	minute := now.Minute()</span><br><span class="line">	second := now.Second()</span><br><span class="line">	fmt.Println(year, month, day, hour, minute, second)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取时间戳：从1970.1.1到现在的秒数</span></span><br><span class="line">	timeStamp1 := now.Unix()     <span class="comment">//该时间戳单位时秒</span></span><br><span class="line">	timeStamp2 := now.UnixNano() <span class="comment">//该时间戳单位是纳秒</span></span><br><span class="line">	fmt.Println(timeStamp1, timeStamp2)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将时间戳转换为具体的时间</span></span><br><span class="line">	<span class="comment">//第一个参数sec是秒为单位，第二个参数nsec是纳秒为单位</span></span><br><span class="line">	t := time.Unix(timeStamp1, <span class="number">0</span>)</span><br><span class="line">	fmt.Println(t)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//时间间隔Duration</span></span><br><span class="line">	<span class="comment">//Duration是time包中定义的一种类型，其中枚举了各种时间单位，比如Hour，Second等</span></span><br><span class="line">	sleepTime := <span class="number">5</span></span><br><span class="line">	<span class="comment">//使用time.Duration将int64转换为Duration类型，使得time.Sleep能够识别</span></span><br><span class="line">	<span class="comment">//time.Sleep作用是使程序睡眠</span></span><br><span class="line">	time.Sleep(time.Duration(sleepTime) * time.Second)</span><br><span class="line"><span class="keyword">go</span></span><br><span class="line">	<span class="comment">//时间差</span></span><br><span class="line">	<span class="comment">//使用now中的Add、Sub方法增加时间或减少时间</span></span><br><span class="line">	t2 := now.Add(time.Hour)</span><br><span class="line">	fmt.Println(t2)</span><br><span class="line">	fmt.Println(t2.Sub(now))</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//使用定时器：</span></span><br><span class="line">    ticker := time.Tick(time.Second)<span class="comment">//定义一个1秒间隔的定时器</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="keyword">range</span> ticker &#123;</span><br><span class="line">        fmt.Println(i)<span class="comment">//每秒都会执行的任务</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="go语言-文件读写"><a class="markdownIt-Anchor" href="#go语言-文件读写">#</a> Go 语言 - 文件读写</h1>
<h2 id="os读取具体使用"><a class="markdownIt-Anchor" href="#os读取具体使用">#</a> os 读取具体使用</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;bufio&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;io&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ReadAll</span><span class="params">(path <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	file, err := os.Open(path)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;open file failed, err:&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">//使用defer关闭文件</span></span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">var</span> temp = <span class="built_in">make</span>([]<span class="type">byte</span>, <span class="number">128</span>)</span><br><span class="line">		n, err := file.Read(temp)</span><br><span class="line">		<span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">			fmt.Println(<span class="type">string</span>(temp[:n]))</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;read from file failed, err:&quot;</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//fmt.Println(&quot;read&quot;, n, &quot;bytes from file.&quot;)</span></span><br><span class="line">		fmt.Printf(<span class="type">string</span>(temp[:n]))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ReadByBufio</span><span class="params">(path <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	file, err := os.Open(path)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;open file failed, err:&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line"></span><br><span class="line">	reader := bufio.NewReader(file)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		line, err := reader.ReadString(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">			fmt.Println(line)</span><br><span class="line">			fmt.Println(<span class="string">&quot;file read over&quot;</span>)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;read file failed, err:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Print(line)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ReadAll(<span class="string">&quot;./example.txt&quot;</span>)</span><br><span class="line">	ReadByBufio(<span class="string">&quot;./example.txt&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="os写入具体使用"><a class="markdownIt-Anchor" href="#os写入具体使用">#</a> os 写入具体使用</h2>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;bufio&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">write</span><span class="params">(path <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	file, err := os.OpenFile(path, os.O_RDWR|os.O_APPEND, <span class="number">0644</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;open file failed, err:&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line"></span><br><span class="line">	str := <span class="string">&quot;Hello World!&quot;</span></span><br><span class="line">	_, err = file.Write([]<span class="type">byte</span>(str))</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;Writer err:&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	_, err = file.WriteString(str)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;WriteString err:&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">writeByBufio</span><span class="params">(path <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">	file, err := os.OpenFile(path, os.O_RDWR|os.O_APPEND, <span class="number">0644</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;open file failed, err:&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line">	writer := bufio.NewWriter(file)</span><br><span class="line"></span><br><span class="line">	_, err = writer.WriteString(<span class="string">&quot;Hello World!&quot;</span>) <span class="comment">//将内容写入缓冲区</span></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;WriteString err:&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	_ = writer.Flush() <span class="comment">//将缓冲区内容写入磁盘</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	write(<span class="string">&quot;./example.txt&quot;</span>)</span><br><span class="line">	writeByBufio(<span class="string">&quot;./example.txt&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="go语言-反射"><a class="markdownIt-Anchor" href="#go语言-反射">#</a> Go 语言 - 反射</h1>
<h1 id="go语言-并发编程"><a class="markdownIt-Anchor" href="#go语言-并发编程">#</a> <mark>Go 语言 - 并发编程</mark></h1>
<h2 id="基本概念"><a class="markdownIt-Anchor" href="#基本概念">#</a> 基本概念</h2>
<p>串行：像串一样，顺序执行。比如先读小学，小学结束读初中，初中结束读高中</p>
<p>并发：同一时间段内执行多个任务。比如上午我要学习和刷视频，可能是学一会儿习，然后刷一会儿视频</p>
<p>并行：同一时刻执行多个任务。比如我在看小说的同时听音乐</p>
<p>进程：程序在操作系统中的一次执行过程，系统进行资源分配和调度的一个独立单位</p>
<p>线程：操作系统基于进程开发的轻量级进程，是操作系统调度执行的最小单位</p>
<p>协程：非操作系统提供而是由用户自行创建和控制的用户态‘线程’，比线程更轻量级</p>
<p>并发模型：</p>
<p>业界将如何实现并发编程总结归纳为各式各样的并发模型，常见的有以下几种：</p>
<ol>
<li>线程 &amp; 锁模型</li>
<li>Actor 模型</li>
<li>CSP 模型</li>
<li>Fork&amp;Join 模型</li>
</ol>
<p>Go 语言中的并发程序主要是通过基于 CSP (communicating sequential processes) 的 goroutine 和 channel 来实现，当然也支持使用传统的多线程共享内存的并发模式</p>
<h2 id="goroutine使用"><a class="markdownIt-Anchor" href="#goroutine使用">#</a> goroutine 使用</h2>
<p>使用关键字 go 来开启一个 goroutine，例如：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> Hello()<span class="comment">//开启一个goroutine来执行Hello函数</span></span><br></pre></td></tr></table></figure>
<p>具体使用：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当主goroutine结束时，由它开启的其他goroutine也会立即结束（不一定执行完了）</span></span><br><span class="line"><span class="comment">// 使用sync包中提供的WaitGroup来记录开启的线程是否执行完成，决定是否等待</span></span><br><span class="line"><span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">	<span class="comment">//使用wg.Done()通知WaitGroup该线程已执行完毕，将计数牌-1</span></span><br><span class="line">	wg.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123; <span class="comment">//开启一个主goroutine去执行main函数</span></span><br><span class="line">	<span class="comment">//在wg中加入一个计数牌</span></span><br><span class="line">	wg.Add(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> hello() <span class="comment">//开启了一个goroutine去执行hello这个函数</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;Hello Main!&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//阻塞，等待所有goroutine都执行完后再结束程序</span></span><br><span class="line">	wg.Wait()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="gomaxprocs"><a class="markdownIt-Anchor" href="#gomaxprocs">#</a> GOMAXPROCS</h3>
<p>通过 runtime 包中的 GOMAXPROCS 可以指定占用的 CPU 数量，Go1.5 版本之后默认使用所有逻辑核心。示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;runtime&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">a</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;a:&quot;</span>, i)</span><br><span class="line">	&#125;</span><br><span class="line">	wg.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">b</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;b:&quot;</span>, i)</span><br><span class="line">	&#125;</span><br><span class="line">	wg.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	runtime.GOMAXPROCS(<span class="number">4</span>) <span class="comment">//占用4个cpu</span></span><br><span class="line">	wg.Add(<span class="number">2</span>)</span><br><span class="line">	<span class="keyword">go</span> a()</span><br><span class="line">	<span class="keyword">go</span> b()</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;main:&quot;</span>, i)</span><br><span class="line">	&#125;</span><br><span class="line">	wg.Wait()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="channel"><a class="markdownIt-Anchor" href="#channel">#</a> channel</h2>
<p>channel 是一种类型，一种引用类型。声明方式如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 变量 <span class="keyword">chan</span> 元素类型</span><br><span class="line"></span><br><span class="line"><span class="comment">//例如：</span></span><br><span class="line"><span class="keyword">var</span> ch1 <span class="keyword">chan</span> <span class="type">int</span>	<span class="comment">//声明一个传递整型的通道</span></span><br><span class="line"><span class="keyword">var</span> ch2 <span class="keyword">chan</span> <span class="type">bool</span>	<span class="comment">//声明一个传递布尔型的通道</span></span><br><span class="line"><span class="keyword">var</span> ch3 <span class="keyword">chan</span> []<span class="type">int</span>	<span class="comment">//声明一个传递int切片的通道</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//channel声明后需要使用make函数进行初始化</span></span><br><span class="line">ch1 = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, [缓冲大小])<span class="comment">//缓冲大小是可选的，可以不填</span></span><br></pre></td></tr></table></figure>
<p>发送：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ch &lt;- <span class="number">10</span><span class="comment">//把10发送到通道ch中</span></span><br></pre></td></tr></table></figure>
<p>接受：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x := &lt;-ch 	<span class="comment">//从ch中接受值并赋值给变量x</span></span><br><span class="line">&lt;-ch		<span class="comment">//从ch中接受值，忽略结果</span></span><br></pre></td></tr></table></figure>
<p>关闭：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">close</span>(ch)<span class="comment">//关闭通道ch</span></span><br></pre></td></tr></table></figure>
<p>需要注意的是，在 go 语言中，channel 的关闭并不一定是必须的。通道是可以被垃圾回收机制回收的。</p>
<p>只有在通知接收方 goroutine 所有的数据都发送完毕的时候才需要关闭通道。</p>
<p>关闭后的通道有以下特点：</p>
<ol>
<li>对一个已经关闭的通道发送值会导致 panic</li>
<li>对一个已经关闭的通道进行接收会一直获取值，直到通道为空</li>
<li>对一个已经关闭的并且没有值的通道执行接收操作会得到对应类型的零值</li>
<li>关闭一个已经关闭的通道会导致 panic</li>
</ol>
<h3 id="缓冲"><a class="markdownIt-Anchor" href="#缓冲">#</a> 缓冲</h3>
<p>无缓冲通道又被称为阻塞的通道，创建如下通道：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>)</span><br><span class="line">	ch &lt;- <span class="number">10</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;send success&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行上面这段代码会导致程序死锁。</p>
<p>这是因为这段代码创建了一个无缓冲区的通道，则该通道无法缓存发送过来的值 10，所以它会一直等待有一个 goroutine 来取走这个值，从而阻塞程序。</p>
<p>而对于有缓冲区的通道：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">1</span>)</span><br><span class="line">	ch &lt;- <span class="number">10</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;send success&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>make 函数里的 1 表示有一个位置的缓冲区，有缓冲区的通道会将发送过来的值暂存值缓冲区，有 goroutine 来取值时，则从缓冲区发送给它。</p>
<p>当缓冲区被存满后，则会变成无缓冲区的阻塞情况。</p>
<h2 id="goroutine与channel联动"><a class="markdownIt-Anchor" href="#goroutine与channel联动">#</a> goroutine 与 channel 联动</h2>
<p>使用示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//将1-100的值存入到ch1中</span></span><br><span class="line"><span class="comment">//将ch1中的值取出，求平方，然后存入ch2中</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这里的chan&lt;-表示ch是一个单向通道，它只能够向通道发送值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">f1</span><span class="params">(ch <span class="keyword">chan</span>&lt;- <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i++ &#123;</span><br><span class="line">		ch &lt;- i</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">close</span>(ch)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这里的&lt;-chan表示ch1是一个单向通道，它只能够从通道中取出值</span></span><br><span class="line"><span class="comment">// chan&lt;-表示ch2是一个单向通道，它只能够向通道发送值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">f2</span><span class="params">(ch1 &lt;-<span class="keyword">chan</span> <span class="type">int</span>, ch2 <span class="keyword">chan</span>&lt;- <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="comment">//从通道中取值的方法1</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		temp, ok := &lt;-ch1</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		ch2 &lt;- temp * temp</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">close</span>(ch2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ch1 := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">100</span>)</span><br><span class="line">	ch2 := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> f1(ch1)</span><br><span class="line">	<span class="keyword">go</span> f2(ch1, ch2)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//从通道中取值的方法2</span></span><br><span class="line">	<span class="keyword">for</span> ret := <span class="keyword">range</span> ch2 &#123;</span><br><span class="line">		fmt.Println(ret)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="worker-poolgiriytube池"><a class="markdownIt-Anchor" href="#worker-poolgiriytube池">#</a> worker pool (giriytube 池)</h2>
<p>工作中通常会使用 workerpool 模式，控制 goroutine 的数量，防止 goroutine 泄露和暴涨，简单示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">worker</span><span class="params">(id <span class="type">int</span>, jobs &lt;-<span class="keyword">chan</span> <span class="type">int</span>, results <span class="keyword">chan</span>&lt;- <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> job := <span class="keyword">range</span> jobs &#123;</span><br><span class="line">		fmt.Printf(<span class="string">&quot;worker:%d start job:%d\n&quot;</span>, id, job)</span><br><span class="line">		results &lt;- job * <span class="number">2</span></span><br><span class="line">		time.Sleep(time.Millisecond * <span class="number">500</span>)</span><br><span class="line">		fmt.Printf(<span class="string">&quot;worker:%d stop job:%d\n&quot;</span>, id, job)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	jobs := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">100</span>)</span><br><span class="line">	results := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//开启3个goroutine</span></span><br><span class="line">	<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="number">3</span>; j++ &#123;</span><br><span class="line">		<span class="keyword">go</span> worker(j, jobs, results)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//发送5个任务</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">		jobs &lt;- i</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">close</span>(jobs)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">		ret := &lt;-results</span><br><span class="line">		fmt.Println(ret)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="select"><a class="markdownIt-Anchor" href="#select">#</a> select</h2>
<p>select 语句的使用类似于 switch，当匹配到其可以执行的操作时，则进行该操作。</p>
<p>需要注意的是，当有多个 case 都满足时，select 并不会顺序执行，而是从中随机抽一个进行执行，使用示例如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">10</span>)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">select</span> &#123;</span><br><span class="line">		<span class="keyword">case</span> x := &lt;-ch:</span><br><span class="line">			fmt.Println(x)</span><br><span class="line">		<span class="keyword">case</span> ch &lt;- i:</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Println(<span class="string">&quot;default&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="并发同步和锁"><a class="markdownIt-Anchor" href="#并发同步和锁">#</a> 并发同步和锁</h2>
<p>有时候在 Go 代码中可能会存在多个 goroutine 同时操作一个资源 (临界区)，这种情况会发生竞态问题 (数据竞态)</p>
<h3 id="互斥锁"><a class="markdownIt-Anchor" href="#互斥锁">#</a> 互斥锁</h3>
<p>互斥锁是一种常用的控制共享资源访问的方法，它能够保证同时只有一个 goroutine 可以访问共享资源</p>
<p>Go 语言中使用 sync 包的 Mutex 类型来实现互斥锁，使用方法如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建全局变量x</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	x    <span class="type">int64</span></span><br><span class="line">	wg   sync.WaitGroup</span><br><span class="line">	lock sync.Mutex</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用两个goroutine，并行给x+50000，形成竞态问题</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">50000</span>; i++ &#123;</span><br><span class="line">		lock.Lock() <span class="comment">//加锁</span></span><br><span class="line">		x += <span class="number">1</span></span><br><span class="line">		lock.Unlock() <span class="comment">//释放锁</span></span><br><span class="line">	&#125;</span><br><span class="line">	wg.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	wg.Add(<span class="number">2</span>)</span><br><span class="line">	<span class="keyword">go</span> add()</span><br><span class="line">	<span class="keyword">go</span> add()</span><br><span class="line">	wg.Wait()</span><br><span class="line">	fmt.Println(x)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="读写互斥锁"><a class="markdownIt-Anchor" href="#读写互斥锁">#</a> 读写互斥锁</h3>
<p>互斥锁是完全互斥的，但有些时候有些资源仅被少量修改，大量读取时，可以尝试仅添加写锁，而不限制其访问。</p>
<p>使用 sync 包中的 RWMutex 类型实现读写锁，具体如下：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建全局变量x</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	x      <span class="type">int64</span></span><br><span class="line">	wg     sync.WaitGroup</span><br><span class="line">	rwLock sync.RWMutex</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模拟读取操作</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">read</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//添加读锁</span></span><br><span class="line">	rwLock.RLock()</span><br><span class="line">	time.Sleep(time.Millisecond)</span><br><span class="line">	<span class="comment">//释放读锁</span></span><br><span class="line">	rwLock.RUnlock()</span><br><span class="line">	wg.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模拟写入操作</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">write</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//添加读写锁</span></span><br><span class="line">	rwLock.Lock()</span><br><span class="line">	x += <span class="number">1</span></span><br><span class="line">	time.Sleep(time.Millisecond * <span class="number">10</span>)</span><br><span class="line">	<span class="comment">//释放读写锁</span></span><br><span class="line">	rwLock.Unlock()</span><br><span class="line">	wg.Done()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	start := time.Now()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//进行一千次读模拟</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++ &#123;</span><br><span class="line">		wg.Add(<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">go</span> read()</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//进行十次写模拟</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		wg.Add(<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">go</span> write()</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	wg.Wait()</span><br><span class="line"></span><br><span class="line">	fmt.Println(time.Now().Sub(start))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="go语言-socket编程"><a class="markdownIt-Anchor" href="#go语言-socket编程">#</a> Go 语言 - socket 编程</h1>
<p>使用 Go 语言内置的 net 包来进行 tcp 或者 udp 通讯</p>
<p><strong>该包所提供的方法，可以查看 Go 语言标准库 -&gt;net 包</strong></p>
<h2 id="tcp样例"><a class="markdownIt-Anchor" href="#tcp样例">#</a> TCP 样例</h2>
<h3 id="server"><a class="markdownIt-Anchor" href="#server">#</a> server</h3>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;bufio&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;net&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">process</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line">	<span class="comment">//处理结束后关闭连接</span></span><br><span class="line">	<span class="keyword">defer</span> conn.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//针对当前的连接做数据的发送和接收操作</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		reader := bufio.NewReader(conn)</span><br><span class="line">		<span class="keyword">var</span> buf [<span class="number">128</span>]<span class="type">byte</span></span><br><span class="line">		n, err := reader.Read(buf[:])</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;read from conn failed, err:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		recv := <span class="type">string</span>(buf[:n])</span><br><span class="line">		fmt.Println(<span class="string">&quot;receive message:&quot;</span>, recv)</span><br><span class="line">		<span class="comment">//把收到的数据返回给客户端</span></span><br><span class="line">		conn.Write([]<span class="type">byte</span>(<span class="string">&quot;ok&quot;</span>))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//1.开启服务，监听端口</span></span><br><span class="line">	address := <span class="string">&quot;localhost:20000&quot;</span></span><br><span class="line">	listen, err := net.Listen(<span class="string">&quot;tcp&quot;</span>, address)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;listen failed, err:&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;listen success.&quot;</span>)</span><br><span class="line">		fmt.Println(<span class="string">&quot;Be listening &quot;</span>, address)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="comment">//2.等待客户端来建立连接</span></span><br><span class="line">		conn, err := listen.Accept()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;accept failed, err:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;connect success&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//3.启动一个单独的goroutine去处理连接</span></span><br><span class="line">		<span class="keyword">go</span> process(conn)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="client"><a class="markdownIt-Anchor" href="#client">#</a> client</h3>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;bufio&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;net&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//1.与服务端建立连接</span></span><br><span class="line">	conn, err := net.Dial(<span class="string">&quot;tcp&quot;</span>, <span class="string">&quot;localhost:20000&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;dial failed, err:&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;dial success&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2.利用该连接进行数据的发送和接收</span></span><br><span class="line">	input := bufio.NewReader(os.Stdin)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		s, _ := input.ReadString(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">		s = strings.TrimSpace(s)</span><br><span class="line">		<span class="keyword">if</span> strings.ToUpper(s) == <span class="string">&quot;Q&quot;</span> &#123;</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//给服务端发消息</span></span><br><span class="line">		_, err := conn.Write([]<span class="type">byte</span>(s))</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;send failed, err:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//从服务端接收回复的消息</span></span><br><span class="line">		<span class="keyword">var</span> buf [<span class="number">1024</span>]<span class="type">byte</span></span><br><span class="line">		n, err := conn.Read(buf[:])</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;read failed, err:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		fmt.Println(<span class="string">&quot;receive server respond:&quot;</span>, <span class="type">string</span>(buf[:n]))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="udp样例"><a class="markdownIt-Anchor" href="#udp样例">#</a> UDP 样例</h2>
<h3 id="server-2"><a class="markdownIt-Anchor" href="#server-2">#</a> server</h3>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;net&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	listen, err := net.ListenUDP(<span class="string">&quot;udp&quot;</span>, &amp;net.UDPAddr&#123;</span><br><span class="line">		IP:   net.IPv4(<span class="number">127</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>),</span><br><span class="line">		Port: <span class="number">30000</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;listen failed, err:&quot;</span>, err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;Be listening 127.0.0.1:30000&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> listen.Close()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">var</span> buf [<span class="number">1024</span>]<span class="type">byte</span></span><br><span class="line">		n, addr, err := listen.ReadFromUDP(buf[:])</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;read from udp failed, err:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(<span class="string">&quot;receive message:&quot;</span>, <span class="type">string</span>(buf[:n]))</span><br><span class="line">		_, err = listen.WriteToUDP(buf[:n], addr)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;write to&quot;</span>, addr, <span class="string">&quot;failed, err:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;send success&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="client-2"><a class="markdownIt-Anchor" href="#client-2">#</a> client</h3>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;bufio&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;net&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	conn, err := net.DialUDP(<span class="string">&quot;udp&quot;</span>, <span class="literal">nil</span>, &amp;net.UDPAddr&#123;</span><br><span class="line">		IP:   net.IPv4(<span class="number">127</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>),</span><br><span class="line">		Port: <span class="number">30000</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;dial failed, err:&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> conn.Close()</span><br><span class="line"></span><br><span class="line">	input := bufio.NewReader(os.Stdin)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		s, _ := input.ReadString(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">		_, err = conn.Write([]<span class="type">byte</span>(s))</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;send to server failed, err:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">var</span> buf [<span class="number">1024</span>]<span class="type">byte</span></span><br><span class="line">		n, addr, err := conn.ReadFromUDP(buf[:])</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;recv from udp failed, err:&quot;</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(<span class="string">&quot;read from&quot;</span>, addr, <span class="string">&quot;message:&quot;</span>, <span class="type">string</span>(buf[:n]))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://www.ailzr.com">Ailzr</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.ailzr.com/2023/06/28/GoLearn/">https://www.ailzr.com/2023/06/28/GoLearn/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.ailzr.com" target="_blank">Ailzr's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Go/">Go</a></div><div class="post_share"><div class="social-share" data-image="/assets/GoLearn.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/08/15/gin-and-gorm/" title="Gin-and-Gorm"><img class="cover" src="/assets/Gin-and-Gorm.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Gin-and-Gorm</div></div></a></div><div class="next-post pull-right"><a href="/2023/06/11/LeetCodeLearn/" title="力扣算法每日一练"><img class="cover" src="/assets/LeetCodeLearn.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">力扣算法每日一练</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/08/15/gin-and-gorm/" title="Gin-and-Gorm"><img class="cover" src="/assets/Gin-and-Gorm.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-15</div><div class="title">Gin-and-Gorm</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Ailzr</div><div class="author-info__description">我有时会想,在这里写点什么好呢</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Ailzr"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Ailzr" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:ailzr@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">搭了一个chatGPT的网站：用不了一点，apikey给干欠费了。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#go%E8%AF%AD%E8%A8%80%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text"> Go 语言介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#go%E8%AF%AD%E8%A8%80%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text"> Go 语言环境安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#windowswin11"><span class="toc-number">2.1.</span> <span class="toc-text"> Windows(win11)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#linuxunbuntu"><span class="toc-number">2.2.</span> <span class="toc-text"> Linux(Unbuntu)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8C"><span class="toc-number">2.3.</span> <span class="toc-text"> 编译运行</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text"> Go 基础语法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="toc-number">3.1.</span> <span class="toc-text"> 注意点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E4%B8%8E%E8%B5%8B%E5%80%BC"><span class="toc-number">3.2.</span> <span class="toc-text"> 变量声明与赋值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#for-range"><span class="toc-number">3.3.</span> <span class="toc-text"> for range</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E4%B8%8E%E5%88%87%E7%89%87"><span class="toc-number">3.4.</span> <span class="toc-text"> 数组与切片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">3.5.</span> <span class="toc-text"> 函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88%E4%B8%8E%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-number">3.6.</span> <span class="toc-text"> 函数指针与回调函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#defer%E5%BB%B6%E8%BF%9F%E6%89%A7%E8%A1%8C"><span class="toc-number">3.7.</span> <span class="toc-text"> defer: 延迟执行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0%E4%B8%8E%E9%97%AD%E5%8C%85"><span class="toc-number">3.8.</span> <span class="toc-text"> 匿名函数与闭包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#panic%E4%B8%8Erecover"><span class="toc-number">3.9.</span> <span class="toc-text"> panic 与 recover</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E4%B8%8Ec%E8%AF%AD%E8%A8%80%E5%9F%BA%E6%9C%AC%E6%97%A0%E5%BC%82%E4%B8%8D%E5%86%8D%E8%B5%98%E8%BF%B0"><span class="toc-number">3.10.</span> <span class="toc-text"> 指针与 C 语言基本无异，不再赘述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#type"><span class="toc-number">3.11.</span> <span class="toc-text"> type</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-number">3.12.</span> <span class="toc-text"> 结构体</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E7%BB%93%E6%9E%84%E4%BD%93"><span class="toc-number">3.12.1.</span> <span class="toc-text"> 定义结构体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">3.12.2.</span> <span class="toc-text"> 结构体初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">3.12.3.</span> <span class="toc-text"> 构造函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%8E%E7%BB%93%E6%9E%84%E4%BD%93%E5%B5%8C%E5%A5%97"><span class="toc-number">3.12.4.</span> <span class="toc-text"> 匿名结构体与结构体嵌套</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E5%92%8C%E6%8E%A5%E6%94%B6%E8%80%85"><span class="toc-number">3.12.5.</span> <span class="toc-text"> 方法和接收者</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E7%BB%A7%E6%89%BF"><span class="toc-number">3.12.6.</span> <span class="toc-text"> 结构体继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E5%AD%97%E6%AE%B5%E7%9A%84%E5%8F%AF%E8%A7%81%E6%80%A7"><span class="toc-number">3.12.7.</span> <span class="toc-text"> 结构体字段的可见性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E4%B8%8Ejson%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">3.12.8.</span> <span class="toc-text"> 结构体与 JSON 序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%A0%87%E7%AD%BEtag"><span class="toc-number">3.12.9.</span> <span class="toc-text"> 结构体标签 (Tag)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%83%E4%B9%A0"><span class="toc-number">3.13.</span> <span class="toc-text"> 小练习：</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#go%E8%AF%AD%E8%A8%80-%E5%8C%85package"><span class="toc-number">4.</span> <span class="toc-text"> Go 语言 - 包 (package)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.1.</span> <span class="toc-text"> 介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%8C%85"><span class="toc-number">4.2.</span> <span class="toc-text"> 定义包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E8%A7%81%E6%80%A7"><span class="toc-number">4.3.</span> <span class="toc-text"> 可见性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#init%E5%87%BD%E6%95%B0%E4%B8%8E%E5%8C%BF%E5%90%8D%E5%8C%85"><span class="toc-number">4.4.</span> <span class="toc-text"> init 函数与匿名包</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#go%E8%AF%AD%E8%A8%80-%E6%8E%A5%E5%8F%A3interface"><span class="toc-number">5.</span> <span class="toc-text"> Go 语言 - 接口 (interface)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%80%BC%E6%8E%A5%E6%94%B6%E8%80%85%E4%B8%8E%E6%8C%87%E9%92%88%E6%8E%A5%E6%94%B6%E8%80%85%E5%85%B3%E4%BA%8E%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="toc-number">5.1.</span> <span class="toc-text"> 值接收者与指针接收者关于接口的差异</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%86%85%E9%83%A8%E5%AD%98%E5%82%A8"><span class="toc-number">5.2.</span> <span class="toc-text"> 接口内部存储</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#go%E8%AF%AD%E8%A8%80%E6%A0%87%E5%87%86%E5%BA%93"><span class="toc-number">6.</span> <span class="toc-text"> Go 语言标准库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#time%E5%8C%85"><span class="toc-number">6.1.</span> <span class="toc-text"> time 包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#os%E5%8C%85"><span class="toc-number">6.2.</span> <span class="toc-text"> os 包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sync%E5%8C%85"><span class="toc-number">6.3.</span> <span class="toc-text"> sync 包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#net%E5%8C%85"><span class="toc-number">6.4.</span> <span class="toc-text"> net 包</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#go%E8%AF%AD%E8%A8%80-%E6%97%B6%E9%97%B4%E5%AF%B9%E8%B1%A1"><span class="toc-number">7.</span> <span class="toc-text"> Go 语言 - 时间对象</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#go%E8%AF%AD%E8%A8%80-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="toc-number">8.</span> <span class="toc-text"> Go 语言 - 文件读写</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#os%E8%AF%BB%E5%8F%96%E5%85%B7%E4%BD%93%E4%BD%BF%E7%94%A8"><span class="toc-number">8.1.</span> <span class="toc-text"> os 读取具体使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#os%E5%86%99%E5%85%A5%E5%85%B7%E4%BD%93%E4%BD%BF%E7%94%A8"><span class="toc-number">8.2.</span> <span class="toc-text"> os 写入具体使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#go%E8%AF%AD%E8%A8%80-%E5%8F%8D%E5%B0%84"><span class="toc-number">9.</span> <span class="toc-text"> Go 语言 - 反射</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#go%E8%AF%AD%E8%A8%80-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B"><span class="toc-number">10.</span> <span class="toc-text"> Go 语言 - 并发编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">10.1.</span> <span class="toc-text"> 基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#goroutine%E4%BD%BF%E7%94%A8"><span class="toc-number">10.2.</span> <span class="toc-text"> goroutine 使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#gomaxprocs"><span class="toc-number">10.2.1.</span> <span class="toc-text"> GOMAXPROCS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#channel"><span class="toc-number">10.3.</span> <span class="toc-text"> channel</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%86%B2"><span class="toc-number">10.3.1.</span> <span class="toc-text"> 缓冲</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#goroutine%E4%B8%8Echannel%E8%81%94%E5%8A%A8"><span class="toc-number">10.4.</span> <span class="toc-text"> goroutine 与 channel 联动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#worker-poolgiriytube%E6%B1%A0"><span class="toc-number">10.5.</span> <span class="toc-text"> worker pool (giriytube 池)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#select"><span class="toc-number">10.6.</span> <span class="toc-text"> select</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E5%90%8C%E6%AD%A5%E5%92%8C%E9%94%81"><span class="toc-number">10.7.</span> <span class="toc-text"> 并发同步和锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%92%E6%96%A5%E9%94%81"><span class="toc-number">10.7.1.</span> <span class="toc-text"> 互斥锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E4%BA%92%E6%96%A5%E9%94%81"><span class="toc-number">10.7.2.</span> <span class="toc-text"> 读写互斥锁</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#go%E8%AF%AD%E8%A8%80-socket%E7%BC%96%E7%A8%8B"><span class="toc-number">11.</span> <span class="toc-text"> Go 语言 - socket 编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#tcp%E6%A0%B7%E4%BE%8B"><span class="toc-number">11.1.</span> <span class="toc-text"> TCP 样例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#server"><span class="toc-number">11.1.1.</span> <span class="toc-text"> server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#client"><span class="toc-number">11.1.2.</span> <span class="toc-text"> client</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#udp%E6%A0%B7%E4%BE%8B"><span class="toc-number">11.2.</span> <span class="toc-text"> UDP 样例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#server-2"><span class="toc-number">11.2.1.</span> <span class="toc-text"> server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#client-2"><span class="toc-number">11.2.2.</span> <span class="toc-text"> client</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/09/11/go-web/" title="go-web"><img src="/assets/GowebCover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="go-web"/></a><div class="content"><a class="title" href="/2023/09/11/go-web/" title="go-web">go-web</a><time datetime="2023-09-11T12:25:02.000Z" title="发表于 2023-09-11 20:25:02">2023-09-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/02/linux-systemctl/" title="Linux系统设置systemctl自动启动"><img src="/assets/LinuxSystemctlCover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux系统设置systemctl自动启动"/></a><div class="content"><a class="title" href="/2023/09/02/linux-systemctl/" title="Linux系统设置systemctl自动启动">Linux系统设置systemctl自动启动</a><time datetime="2023-09-02T09:38:00.000Z" title="发表于 2023-09-02 17:38:00">2023-09-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/02/Redis/" title="Redis"><img src="/assets/RedisCover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis"/></a><div class="content"><a class="title" href="/2023/09/02/Redis/" title="Redis">Redis</a><time datetime="2023-09-02T07:41:52.000Z" title="发表于 2023-09-02 15:41:52">2023-09-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/08/15/gin-and-gorm/" title="Gin-and-Gorm"><img src="/assets/Gin-and-Gorm.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Gin-and-Gorm"/></a><div class="content"><a class="title" href="/2023/08/15/gin-and-gorm/" title="Gin-and-Gorm">Gin-and-Gorm</a><time datetime="2023-08-15T12:42:00.000Z" title="发表于 2023-08-15 20:42:00">2023-08-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/06/28/GoLearn/" title="Go"><img src="/assets/GoLearn.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Go"/></a><div class="content"><a class="title" href="/2023/06/28/GoLearn/" title="Go">Go</a><time datetime="2023-06-28T11:46:13.000Z" title="发表于 2023-06-28 19:46:13">2023-06-28</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By Ailzr</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  function abcjsInit() {
    function abcjsFn() {
      for (let abcContainer of document.getElementsByClassName("abc-music-sheet")) {
        ABCJS.renderAbc(abcContainer, abcContainer.innerHTML, {responsive: 'resize'})
      }
    }
    
    typeof ABCJS === 'object' ? abcjsFn()
      : getScript('https://cdn.jsdelivr.net/npm/abcjs/dist/abcjs-basic-min.min.js').then(abcjsFn)
  }

  window.pjax ? abcjsInit() : document.addEventListener('DOMContentLoaded', abcjsInit)
})()</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'l4Dq9lpMxp11shkV9svLzBv2-gzGzoHsz',
      appKey: 'uPnBcmbPIzZ6IeAr1sH90xCc',
      avatar: 'monsterid',
      serverURLs: 'https://l4dq9lpm.lc-cn-n1-shared.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: true
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>